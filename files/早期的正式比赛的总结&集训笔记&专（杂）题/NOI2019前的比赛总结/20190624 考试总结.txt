# 20190624 考试总结

标签（空格分隔）： 总结

---

### T1 旅途

一张$n$个点、$m$条边的带权无向图，你只需要为路径上边权前$k$大的边付出代价，为对于每一个$k\in [1,n]$，从$1$到$n$的最短路。$n,m\le 3000$

Solution：

这是做过的原题，但是我只得了60分，原因是手写堆里面，有一个参数本来应该传那个点在堆的数组中的下标，我传成了那个点的编号。

随机数据中的最短路，图中的最短路的点数都很少，堆里面的元素也会很少，所以对拍都不一定会发现其中的错误。如果以后要写自己不太熟悉的数据结构，最好单独把数据结构拿出来对拍。

---

### T2 翻折

定义一个字符串是好的，当且仅当它的长度是偶数并且前一半和后一半完全相同。例如：$abab$。给出一个字符串$S$，你需要求出它的好的子串的个数。$|S|\le 10^5,T\le 3$

Solution：

做法1：考虑枚举$[l,r]$中的$l$和${l+r+1\over 2}$，这两个点能够产生贡献当且仅当它们的$lcp$大于等于它们的下标的差。建出SA，在上面分治 + 启发式合并就可以了。时间复杂度$O(n\log ^2 n)$

做法2：考虑枚举长度除以$2$，设这个长度为$L$。对于每一个$L$，我们在整个串中每隔$L$个字符设一个关键点，然后求出相邻关键点的$lcp$和$lcs$统计贡献就可以了。这是因为，对于一个长度为$2L$的子串它一定恰好包含两个关键点。时间复杂度$O(n\log n)$。

---

### T3 谜

有$n$个男生，$n$个女生，用一个$n\times n$的矩阵$M$表示，$M_{i,j}$表示第$i$个男生和第$j$个女生是否可以配对。有$m$个备胎男生和$k$个备胎女生，可以和他们每个人配对的女生/男生也会在输入中给出。你需要求出匹配方案数对$2$取模的值。

有两种操作：一种是将$n$个男生中的一个换成备胎男生中的一个；一种是将$n$个女生中的一个换成备胎女生中的一个。共有$q$次操作，你需要在每次操作后输出匹配方案数。操作没有后效性。

$n,q,m,k\le 1000$

Solution：

考虑没有修改的时候，答案就是：
$$
\sum_p \prod M_{i,p_i}
$$

由于对$2$取模，$1\equiv -1 \mod 2$，所以上式与行列式相等。（注意消成上三角矩阵过后，行列式是对角线的乘积而不是对角线的和，所以当矩阵满秩的时候，答案就是$1$而不是 n & 1 ！！）

问题转化成，修改一行的元素，判断矩阵是否满秩。

那么修改前矩阵的秩一定是$n$或者$n-1$。

如果修改前矩阵的秩是$n$：将要加入进去的那个行向量一定可以表示成原矩阵的若干行的组合，那么这个行向量覆盖的行必须是参与了组合的那几行中的一个，否则就会与那些行线性相关，矩阵就不满秩了。反之，修改后的矩阵就一定满秩。

如果修改前矩阵的秩是$n-1$：首先找出那一组线性相关的向量，新的元素一定会覆盖这一组向量中的一个。并且，新的元素一定不能够通过原来矩阵中的元素的组合表示出来。

还有一种做法是直接分治，求出除了某个元素以外的所有元素组成的线性基。把线性基消成对角线，考虑这个时候对角线上还没有被占据的那一列$p$，看第$p$列上，哪些行的取值是$1$。我们只需要关心加进去的元素中为$1$的那些列 与 这些在所对应的行第$p$列上为$1$的列 的交的大小的奇偶性 就可以了。复杂度要多一个$\log n$，但是可以卡过。