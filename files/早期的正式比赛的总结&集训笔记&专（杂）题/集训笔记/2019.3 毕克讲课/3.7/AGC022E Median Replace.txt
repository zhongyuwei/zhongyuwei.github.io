### [AGC022E Median Replace](https://agc022.contest.atcoder.jp/tasks/agc022_e)

对于一个长度为$n$的01序列（保证$n$为奇数），每一次操作可以选择一个长度为$3$的区间，将这个区间替换为这三个数的中位数。输入一个长度为$n$的字符串，其中有‘0’，‘1’，‘？’三种字符，问有多少种把‘？’替换为‘0’或者‘1’的方案，使得这个字符串在经过$n-1\over 2$次操作之后，剩下的数是$1$。$n\le 300000$

Solution：

贪心的策略是这样的：

- 如果序列中有000，我们一定会把他变成 001
- 如果序列中没有000， 我们会把一个由两个1和1个0组成的子串变成1，或者选择一个包含两个0，一个1的子串，把它变成0
- 如果没有以上的情况，那么此时的序列无论我们怎么操作，最后得到的都是1

由这样的一个策略，我们可以构建出一个自动机：

![](E:\钟雨薇\2019.3 毕克讲课\3.7\我画的自动机.PNG)

再自动机上dp即可。

